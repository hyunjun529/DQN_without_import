import numpy as np
from envFive import envFive


# env
env = envFive()
input_size = 12
output_size = 1


def relu(x):
    return np.maximum(x, 0)

def sigmoid(x, derivative=False):
  return x*(1-x) if derivative else 1/(1+np.exp(-x))

def act(ob):
    x = ob
    x = relu(np.dot(x, weights_dense1_w) + weights_dense1_b)
    x = sigmoid(np.dot(x, weights_final_w) + weights_final_b)
    return x


def main():
    cnt_win = 0
    cnt_lose = 0
    cnt_draw = 0
    while True:
        observation = env.reset()
        done = False
        while not done:
            x = np.reshape(observation, [1, input_size])
            action = act(x)[0][0][0][0] # sorry
            observation, reward, done, info = env.step(action)
        if info[0] > info[1]:
            cnt_win += 1
        elif info[0] < info[1]:
            cnt_lose += 1
        else:
            cnt_draw += 1
        if (cnt_win + cnt_lose + cnt_draw) % 200 == 0:
            print(" : {}승 {}패 {}무 ({})".format(cnt_win,cnt_lose,cnt_draw,(cnt_win)/(cnt_win+cnt_lose+0.001)))
            

weights_dense1_w = np.array([
[[-0.0994 , -0.11027, -0.05094,  0.16364, -0.26365, -0.00508,  0.01065,  0.03245,
  -0.02081, -0.16932,  0.20776,  0.09682, -0.18162,  0.03275,  0.06676,  0.05628,
   0.17406, -0.00219, -0.15837, -0.22784,  0.23246,  0.23047,  0.13392,  0.25628,
  -0.11652, -0.1934 , -0.01617,  0.07743,  0.22591,  0.22915,  0.05814,  0.11706,
   0.17113, -0.0048 , -0.17146,  0.26999,  0.18229, -0.18188,  0.06244,  0.14572,
   0.03586,  0.16589, -0.15605,  0.01184, -0.13278,  0.23058, -0.09501,  0.09751,
   0.15597, -0.23734,  0.27077, -0.20391, -0.21271, -0.03722,  0.18194, -0.04991,
   0.13319,  0.2782 , -0.10523,  0.11217,  0.07268,  0.26759,  0.1569 ,  0.25799,],
 [-0.19064, -0.11127,  0.16553,  0.24576, -0.03452,  0.25421, -0.12973, -0.23528,
   0.17021, -0.17937, -0.01513, -0.20338, -0.21567, -0.02735,  0.16327,  0.09412,
   0.10931, -0.17792, -0.10098,  0.25114, -0.13223,  0.10719,  0.28154, -0.07461,
   0.12398, -0.22383, -0.04183, -0.04103,  0.17552,  0.02901,  0.10295, -0.22829,
  -0.24354, -0.27137, -0.26316, -0.14122,  0.10842, -0.20479,  0.15018, -0.08054,
  -0.23127, -0.15555,  0.2119 ,  0.03675,  0.03168,  0.12511,  0.0969 , -0.19564,
   0.25674, -0.2383 , -0.23912,  0.18523, -0.08525, -0.08377,  0.20071,  0.02781,
   0.11492,  0.20788, -0.20945,  0.11146,  0.18953,  0.24178, -0.17916, -0.16604,],
 [-0.11608, -0.03075, -0.24279, -0.03787, -0.2265 , -0.07519,  0.23876,  0.22833,
   0.09641,  0.24838, -0.14242,  0.05617,  0.1648 ,  0.18626, -0.17897, -0.03915,
   0.18023, -0.0273 , -0.14138,  0.18145,  0.17399,  0.19021, -0.02828,  0.11892,
   0.09436, -0.24348, -0.14195,  0.09064,  0.21958,  0.05693, -0.19417,  0.10665,
  -0.13812,  0.11284, -0.26074, -0.20637, -0.17056,  0.00115, -0.18761, -0.25634,
  -0.03933,  0.21307, -0.04387, -0.17294,  0.1316 ,  0.17042,  0.16224, -0.08005,
  -0.05484,  0.13459,  0.16643, -0.04889, -0.10616,  0.17731, -0.20588, -0.04348,
  -0.16757,  0.07828,  0.2089 ,  0.27494, -0.09166,  0.19456, -0.19514, -0.13624,],
 [ 0.12711, -0.22191,  0.01426, -0.27031, -0.13941,  0.19098,  0.14808, -0.15995,
  -0.04659,  0.16567, -0.22624,  0.21293,  0.20284, -0.07917,  0.14998, -0.0603 ,
   0.24623, -0.12657,  0.18904, -0.24062,  0.10163,  0.11689,  0.13171,  0.12667,
   0.27516,  0.17427, -0.04275, -0.27173,  0.04338,  0.11863, -0.10027,  0.10953,
   0.21855, -0.15685,  0.0459 ,  0.11068, -0.1476 , -0.0802 ,  0.21877, -0.24498,
   0.17813, -0.2986 , -0.0981 ,  0.19017, -0.20587,  0.10063,  0.11183, -0.28846,
   0.25229,  0.22712, -0.25452,  0.23715, -0.1064 ,  0.13005, -0.05224, -0.10715,
  -0.20789,  0.08129,  0.13946, -0.17696,  0.16732,  0.15799,  0.21703,  0.12666,],
 [-0.15496, -0.25775, -0.13725,  0.24918, -0.06933,  0.27286,  0.22964, -0.10275,
  -0.17102,  0.03484,  0.20858, -0.17242, -0.04534, -0.05156,  0.21428,  0.0404 ,
   0.04906, -0.23627,  0.16119,  0.22593, -0.05299, -0.01998,  0.07279,  0.00385,
   0.02026, -0.2546 , -0.23617,  0.02867, -0.2296 ,  0.22041,  0.01122,  0.04507,
  -0.09991,  0.03655, -0.07769, -0.20717,  0.26891,  0.14157,  0.08989, -0.05701,
  -0.14501, -0.10214,  0.16511,  0.09995, -0.14143,  0.22675, -0.28711,  0.04015,
   0.20463,  0.16075,  0.04361, -0.1771 ,  0.2744 , -0.13701, -0.12029, -0.26067,
  -0.28298,  0.20047, -0.25196,  0.06677, -0.0524 ,  0.09583, -0.26416,  0.07668,],
 [ 0.04066,  0.25586, -0.19598,  0.12715, -0.13162,  0.05111,  0.23133, -0.11923,
   0.1821 ,  0.0623 ,  0.19872, -0.26487,  0.21107, -0.10754, -0.0318 , -0.20576,
  -0.08119,  0.23917, -0.09009, -0.0061 , -0.0502 , -0.2466 ,  0.06983, -0.20701,
  -0.24073,  0.26216,  0.18384, -0.10703,  0.02056, -0.27732,  0.10809,  0.26348,
   0.02208,  0.21864, -0.2242 ,  0.18153,  0.02331,  0.08465, -0.00583,  0.09318,
  -0.12363, -0.03312, -0.13172, -0.27414,  0.22377, -0.17624, -0.20907, -0.10874,
  -0.04532, -0.00112, -0.22806, -0.17695,  0.0916 , -0.17492, -0.20499,  0.01692,
  -0.13823,  0.1024 ,  0.05334, -0.19221, -0.1903 , -0.17876, -0.05676,  0.13048,],
 [ 0.19677,  0.25344,  0.04774,  0.19605,  0.02359, -0.05076, -0.09662,  0.2684 ,
  -0.14226, -0.21388,  0.0167 ,  0.17599,  0.15026, -0.0845 , -0.24044,  0.16212,
   0.0169 ,  0.2221 ,  0.24309,  0.09311,  0.01388,  0.09933, -0.08398, -0.08139,
   0.187  , -0.17643,  0.22107, -0.15287,  0.22776,  0.10701, -0.1168 ,  0.24461,
   0.04105,  0.22692,  0.13193,  0.1427 ,  0.04656, -0.2319 ,  0.11119,  0.01087,
  -0.22   , -0.18153,  0.18842,  0.26476, -0.01949, -0.08935, -0.01437, -0.27523,
  -0.1041 , -0.20551, -0.22456,  0.16674,  0.23432,  0.1027 ,  0.06683,  0.21938,
   0.20964,  0.04884,  0.10785, -0.06606,  0.20685,  0.24394, -0.04873,  0.19534,],
 [-0.03198, -0.01571, -0.20456,  0.15964, -0.17231, -0.00051,  0.0648 ,  0.06703,
   0.28688, -0.06802,  0.11459,  0.2658 , -0.04752,  0.27655,  0.27729, -0.11708,
   0.29428,  0.18758, -0.23755, -0.07728,  0.06077,  0.01879,  0.00943,  0.00744,
  -0.26564, -0.10525, -0.11795, -0.14052,  0.13587,  0.11689,  0.02878,  0.09868,
  -0.05349, -0.1396 , -0.04163, -0.11812, -0.17125,  0.1562 , -0.14028, -0.17212,
   0.14769,  0.0002 , -0.21405,  0.05702, -0.08059, -0.19692,  0.09465,  0.04353,
  -0.02221, -0.0262 ,  0.24199,  0.00622, -0.16907, -0.23607, -0.27561, -0.06408,
   0.1969 ,  0.13637, -0.17192, -0.06036, -0.03766, -0.25469,  0.0134 , -0.28953,],
 [ 0.20208, -0.10686,  0.20849, -0.15972,  0.27867, -0.19796, -0.09165, -0.01332,
   0.05852, -0.26281, -0.0246 ,  0.17484,  0.17368,  0.15788,  0.15322, -0.24397,
  -0.21859,  0.13854,  0.02875,  0.11074,  0.05423, -0.12349, -0.12857, -0.21196,
   0.0829 , -0.25323,  0.22218,  0.15773,  0.1875 , -0.00722,  0.26541,  0.10199,
   0.19801,  0.15886,  0.0808 ,  0.26308,  0.26172,  0.15256,  0.23299,  0.05701,
   0.15706, -0.05768, -0.03883,  0.05421, -0.19888,  0.00168, -0.04512,  0.12313,
   0.12056,  0.22282,  0.1883 , -0.17121,  0.15791,  0.1083 , -0.23825,  0.26628,
   0.26305,  0.02036,  0.08442,  0.18744,  0.21063, -0.24228,  0.12809,  0.02632,],
 [-0.06515, -0.19487, -0.10927,  0.05375, -0.20581,  0.07925, -0.27911,  0.18046,
   0.01561, -0.12644,  0.16843, -0.1582 , -0.13279, -0.14083,  0.18945, -0.27957,
  -0.12183, -0.10621,  0.0679 ,  0.04318,  0.07847, -0.17935, -0.01987, -0.03538,
   0.18088,  0.17423, -0.08152, -0.26299,  0.14051, -0.11793,  0.04554, -0.19317,
   0.28113, -0.20216, -0.08487,  0.15909, -0.11911,  0.1378 ,  0.17452,  0.12298,
  -0.2414 , -0.22263, -0.19979, -0.21939, -0.01974,  0.00623,  0.27026,  0.2645 ,
   0.01224,  0.03638, -0.18461, -0.10065,  0.24877,  0.05532, -0.28107,  0.23825,
   0.26051,  0.2311 ,  0.16227, -0.10123,  0.04177,  0.11172, -0.00157, -0.05837,],
 [-0.22987, -0.18246, -0.27093,  0.20816,  0.25843,  0.29155, -0.26162, -0.21783,
   0.03561,  0.11703,  0.25814, -0.26246, -0.19122,  0.27774,  0.26633,  0.19124,
   0.11802,  0.16088, -0.20337, -0.01622,  0.17588,  0.1655 ,  0.30221,  0.11186,
  -0.12154,  0.20005, -0.27293,  0.20797, -0.17658, -0.26334, -0.02646, -0.12341,
  -0.08562,  0.18226, -0.05135,  0.15498, -0.14025, -0.0717 ,  0.15323, -0.13583,
  -0.18814,  0.24728,  0.01863, -0.23492,  0.10101,  0.23751,  0.0522 ,  0.14242,
   0.07818, -0.24994,  0.22823, -0.10103, -0.07956,  0.11589,  0.02672, -0.03445,
   0.01858, -0.14515,  0.21289, -0.0965 ,  0.26976, -0.15488,  0.26476, -0.24835,],
 [-0.08713,  0.10101,  0.26535, -0.21662, -0.13331, -0.20368, -0.03783, -0.01732,
   0.09919, -0.08779,  0.19414,  0.06324,  0.1492 ,  0.08625, -0.15189,  0.23373,
  -0.09345,  0.22549,  0.11597,  0.24478,  0.14056, -0.17886, -0.24063, -0.11526,
   0.05355,  0.03896,  0.13455, -0.03318, -0.16981, -0.01651, -0.03014, -0.02379,
  -0.07352,  0.16631, -0.0362 ,  0.01821, -0.12257, -0.0773 , -0.24948,  0.21407,
  -0.22504, -0.11601,  0.21215,  0.02443, -0.00872, -0.11266,  0.22586, -0.06292,
  -0.2279 , -0.01919,  0.11815, -0.1303 , -0.03558, -0.28165, -0.11167, -0.02708,
  -0.0046 ,  0.02066, -0.11067,  0.05666,  0.00149,  0.13638, -0.03342, -0.2776 ,]]
])

weights_dense1_b = np.array([
[-0.16742, -0.10503, -0.12456, -0.06545,  0.13048,  0.18742,  0.11497, -0.15471,
  0.18768, -0.21261, -0.06275,  0.15538,  0.05601, -0.14473, -0.17811, -0.14166,
 -0.18928, -0.17283,  0.13949, -0.1677 , -0.03594,  0.16035, -0.04822,  0.21842,
  0.116  , -0.02331, -0.08291, -0.15976, -0.06996, -0.0675 ,  0.01165, -0.1254 ,
  0.06899,  0.09531,  0.12766, -0.14764, -0.08035, -0.00006, -0.20236,  0.09024,
  0.20925, -0.13359,  0.08415, -0.08535, -0.15761,  0.08583,  0.06402,  0.04668,
  0.22382, -0.09777, -0.05277,  0.05983,  0.05622,  0.00419, -0.18582,  0.01074,
  0.05192,  0.00953, -0.14502,  0.00202, -0.18993,  0.20169, -0.13459, -0.08364,]
])

weights_final_w = np.array([
[[ 0.22352],
 [ 0.27025],
 [ 0.0436 ],
 [-0.12655],
 [ 0.24468],
 [ 0.21126],
 [ 0.1106 ],
 [-0.11252],
 [ 0.29598],
 [-0.28624],
 [ 0.07801],
 [-0.14231],
 [ 0.14332],
 [ 0.09393],
 [ 0.23154],
 [-0.21554],
 [ 0.15087],
 [ 0.27596],
 [ 0.2208 ],
 [ 0.07621],
 [-0.22148],
 [ 0.09836],
 [ 0.18322],
 [ 0.14921],
 [-0.07665],
 [ 0.08838],
 [-0.03253],
 [-0.00497],
 [-0.17125],
 [-0.17042],
 [-0.27215],
 [-0.27539],
 [-0.30425],
 [-0.23097],
 [-0.20085],
 [ 0.21923],
 [ 0.11393],
 [ 0.19613],
 [-0.14485],
 [-0.16569],
 [ 0.22054],
 [ 0.25874],
 [ 0.2535 ],
 [ 0.14972],
 [ 0.19115],
 [ 0.28874],
 [-0.23708],
 [ 0.28254],
 [ 0.18289],
 [-0.11835],
 [-0.14531],
 [-0.09735],
 [ 0.27607],
 [ 0.17168],
 [ 0.1006 ],
 [-0.04092],
 [-0.04   ],
 [ 0.042  ],
 [-0.00196],
 [-0.02296],
 [ 0.08021],
 [ 0.25005],
 [-0.15997],
 [ 0.13103],]
])

weights_final_b = np.array([
[-0.51145]
])


if __name__=="__main__":
    main()